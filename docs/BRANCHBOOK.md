### Структура веток

- `main` — стабильный релиз, продуктив. Только проверенный код через PR, авто-теги релизов.
- `infra` — инфраструктура, CI/CD, Terraform/Docker/helm чарты. Помимо поддерживающего DevOps-инженера никто не пишет сюда напрямую; фичи отводим в краткоживущие `infra/*` и льём через PR.
- `notebooks` — исследовательские ноутбуки, быстрые эксперименты, прототипы моделей. Для чистовой разработки выделяем ветки `notebooks/*`, после ревью переносим ценные находки в `main`.
- `docs` — документация, чек-листы QA, e2e/acceptance-тесты. Рабочие ветки `docs/*`.

### Алгоритм разработки (модель “trunk + короткие feature-ветки”)

1. **Issue / задача.** Описываем в таск-трекере, привязываем к milestone.
2. **Ветка.** Разработчик отводит `infra/<feature>`, `notebooks/<feature>` или `docs/<feature>` — в зависимости от направления.
3. **Разработка.**
   - Минимум, но частые коммиты (согл. CC-правил).
   - Прогоняем локальные тесты / линтер / ноутбуки (`nbconvert`, `pytest`, `terraform validate`).
4. **Pull Request → main.**
   - Шаблон PR: цель, изменения, чек-лист.
   - Авто-валидация: GH Actions/CI (линтеры, юниты, e2e и т. п.).
   - Код-ревью обязательное (другая роль: коллега/лид/DevOps).
5. **Слияние.**
   - Только Merge Commit / Squash после зелёного CI.
   - В PR никакого `git push --force` (только если переписываем черновик до ревью; после ревью — `merge` через GitHub).
6. **Релизы.**
   - Tag при апруве новой версии (`v1.2.3`).
   - Авто-деплой из `main` через пайплайн из `infra`.
7. **Чистка.**
   - Раз в спринт автоудаление merged-веток.
   - `git gc --prune=now` **не** ставим в CI.

### Взаимодействие команд

- **Разработчики ML / фичи:** работают в `notebooks`, собирают прототипы, затем переносят код в `main` (через отдельные ветки для интеграции).
- **DevOps:** поддерживает `infra`, настраивает CI/CD, деплой, мониторинг. Сливает в `main` только проверенные CI-конфиги.
- **Документация/QA:** снабжают `docs` всем новым функционалом; регулярно синхронизируются с `main`, чтобы документация не расходилась с кодом.

### Итоговая схема

```
                ┌──────────┐
                │  main    │ ← релизы, прод
                └────┬─────┘
                     │
         ┌───────────┼───────────┐
         │           │           │
     notebooks     infra        docs
(исследования) (DevOps/CI) (доки/e2e)

От каждой базовой ветки — feature-ветки:
notebooks/exp-xxx → PR → main
infra/cicd-yyy → PR → main
docs/update-zzz → PR → main
```

Стартовым агентом назначаем владельца проекта: он смотрит на health `main`, развивает `infra`, следит за ритмом спринтов. Второй разработчик подключается к нужной ветке и ведёт свои задачи, не ломая основу.